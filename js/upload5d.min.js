(function(q){function x(a,b,c){a.innerHTML+=b;c&&(a.className="failure",y++)}function r(a){a.stopPropagation();a.preventDefault();a.target.className="dragover"==a.type?"hover":""}function z(a){A=l.offsetWidth;r(a);a=a.target.files||a.dataTransfer.files;for(var b=0,c;c=a[b];b++)s+=c.size,d.push(c),m.innerHTML=d.length,n(!1,"fsel");d.length&&(e.style.display=t)}function B(){f||(allDone=1,typeof("function"==fup_done)&&fup_done(y))}function n(a,b){a&&(--g||B());!f&&d.length&&(!u||g<u)&&(new C(d.shift()),
g++,m.innerHTML=d.length);0>=d.length&&(e.style.display=h,k.style.display=h)}function v(a){l&&(w+=a,l.style.backgroundPosition=Math.floor(A*w/s)-800+"px 0")}function C(a){var b=this,c=null;this.lastsz=0;this.fsize=a.size;this.doAbort=function(){this.xhr?this.xhr.abort():p.removeChild(this.progress)};this.xhr=new XMLHttpRequest;if(this.xhr.upload)if(this.xhr.upload.onabort=function(a){v(b.fsize-b.lastsz)},this.xhr.upload.onloadstart=function(c){this.onprogress=function(c){c.lengthComputable&&(b.progress.style.backgroundPosition=
Math.floor(b.progressW*c.loaded/c.total)-800+"px -20px",c.loaded==c.total&&(b.progress.innerHTML=a.name,b.progress.className="indeterm",b.progress.style.backgroundPosition=""),v(c.loaded-b.lastsz),b.lastsz=c.loaded)}},"object"==typeof fup_ftypes&&0>fup_ftypes.indexOf(a.type)?c="Cannot upload a file of this type. ("+a.type+")":a.size>document.getElementById("MAX_FILE_SIZE").value&&(c="File is larger than max size allowed."),this.progress=p.appendChild(document.createElement("p")),this.progress.appendChild(document.createTextNode(a.name)),
this.progress.innerHTML=this.progress.innerHTML+'<img src="'+fmx_appPath+'css/redX.png" class="abortX" onclick="AbortUpload(this);" />',this.progressW=this.progress.offsetWidth,this.progress._upld=this,c)x(this.progress,"<br />"+c,!0),v(a.size),n(!0,"errM");else if(this.xhr.onreadystatechange=function(a){a="";4==b.xhr.readyState&&(200==b.xhr.status?(a=b.xhr.responseText,a="Ok"==a?"":"<br />"+a):a=0===b.xhr.status?a+"<br />-- aborted":a+("<br />"+b.xhr.status+": "+b.xhr.statusText),a?x(b.progress,
a,!0):p.removeChild(b.progress),n(!0,"rst"))},this.xhr.open("POST",fmx_appPath+"upload5.php",!0),fup_payload){c=new FormData;c.append("user_file[]",a);for(var d in fup_payload)c.append(d,fup_payload[d]);this.xhr.send(c)}else this.xhr.setRequestHeader("Content-Type","application/octet-stream"),this.xhr.setRequestHeader("X_FILENAME",a.name),this.xhr.send(a)}function D(){var a=document.getElementById("upload_field"),b=document.getElementById("dropArea"),c=document.getElementById("submitbutton");m=document.getElementById("qCount");
e=document.getElementById("qstop");k=document.getElementById("qgocan");a&&a.addEventListener("change",z,!1);(new XMLHttpRequest).upload&&(b.addEventListener("dragover",r,!1),b.addEventListener("dragleave",r,!1),b.addEventListener("drop",z,!1),b.style.display="block",c&&(c.style.display="none"),l=document.getElementById("totprogress"),p=document.getElementById("fprogress"))}var l,A,p,m,d=[],u=3,f=!1,g=0,s=0,w=0,y=0,e,k,h="none",t="inline-block";window.File&&window.FileList&&D();q.fupQctrl={stop:function(){f=
!0;e.style.display=h;k.style.display=t},go:function(){f=!1;e.style.display=t;for(k.style.display=h;d.length&&g<u;)n(!1,"go")},cancel:function(){d.length=0;f=!1;k.style.display=h;m.innerHTML=0;g||B()}}})(window);function AbortUpload(q){q.parentNode._upld.doAbort()};