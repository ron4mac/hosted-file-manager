'use strict';function $id(f){return document.getElementById(f)}function $ae(f,L,z){f.addEventListener(L,z,!1)}
(function(f,L,z){function P(b,a){let c=this;c.show=k=>{c.pb.style.width=100*k+"%";1===k&&(c.pb.className="indeterm")};c.msg=(k,l)=>{c.pbi.innerHTML+="<br />"+k;l&&(c.pbi.className="pbfinf failure",A++)};c.rmov=()=>{c.pbw._ufo=null;B.removeChild(c.pbw);c.fObj=null};let g=n("div","",{class:"pbwrp"});c.pb=g.appendChild(n("div","",{class:a}));c.pbi=g.appendChild(n("div",b.fn+'<i class="fa fa-window-close abortX" aria-hidden="true" onclick="this.parentNode.parentNode._ufo.abort(true);"></i>',{class:"pbfinf"}));
B.appendChild(g);c.pbw=g;c.pbw._ufo=b;c.fObj=b;return c}function Q(b){let a=this;a.upFile=b;a.fn=b.fileName||b.name;a.size=b.size;a.upState="";a.doChnk=a.upFile.size>M;a.chnkSize=Math.round(M/2)-3072;a.relPath=b.webkitRelativePath||a.fn;a.uniqueId=a.size+"-"+a.relPath.replace(/[^0-9a-zA-Z_-]/img,"");a.actSize=a.startByte=a.lastsz=a.chnkNum=0;a.numChnks=Math.max(Math.floor(a.size/a.chnkSize),1);a.fData=a.pBar=null;a.upForm={};a.X=new XMLHttpRequest;const c=d=>{a.X&&(a.X.upload.onprogress=null,a.X.onabort=
null,a.X.onerror=null,a.X.onload=null,a.X=null);a.fData=null;d&&a.pBar&&(a.pBar.rmov(),a.pBar=null);v(!0,"ufo")},g=()=>{a.fData=new FormData;m(a.fData,e.payload);switch(a.upState){case "":m(a.fData,a.upForm);a.fData.append("Filedata",a.upFile);a.upState="upld";break;case "upld":c(!0);return}a.X.open("POST",e.upURL);a.X.send(a.fData)},k=()=>{a.fData=new FormData;m(a.fData,e.payload);switch(a.upState){case "":m(a.fData,{chunkact:"pref",file:a.fn,size:a.size,ident:a.uniqueId});a.upState="chnk";break;
case "chnk":m(a.fData,{chunkact:"chnk",ident:a.uniqueId,fname:a.fn,tchnk:a.numChnks});if(a.chnkNum==a.numChnks){c(!0);return}a.startByte=a.chnkNum*a.chnkSize;a.endByte=Math.min(a.size,(a.chnkNum+1)*a.chnkSize);a.size-a.endByte<a.chnkSize&&(a.endByte=a.size);a.actSize=a.endByte-a.startByte;a.fData.append("chnkn",++a.chnkNum);a.chnkNum==a.numChnks&&m(a.fData,a.upForm);a.fData.append("Filedata",a.upFile[N](a.startByte,a.endByte));a.lastsz=0;break;case "abrt":a.X.timeout=1E4;m(a.fData,{chunkact:"abrt",
ident:a.uniqueId,fname:a.fn});a.upState="nil";break;case "nil":c();return}a.X.open("POST",e.upURL);a.X.send(a.fData)},l={prog:d=>{if(d.lengthComputable){var p=Math.round(d.loaded/d.total*a.actSize);"chnk"==a.upState&&a.chnkNum?(a.pBar.show((a.startByte+p)/a.size),C(p-a.lastsz),a.lastsz=p):"upld"==a.upState&&(a.pBar.show(d.loaded/d.total),p=Math.round(d.loaded/d.total*a.size),C(p-a.lastsz),a.lastsz=p)}},load:()=>{a.X.responseText.length?a.pBar.msg(a.X.responseText,!0):a.doChnk?k():g()},abrt:()=>{a.pBar.msg("-- Aborted",
!0);a.doChnk?(a.upState="abrt",k()):c()},fail:()=>{a.pBar.msg(a.X.responseText,!0);c()}};a.abort=()=>{if(a.X){let d=a.X.readyState;4>d&&0!==d?a.X.abort():l.abrt()}else a.pBar.rmov(),a.pBar=null};a.pBar=new P(a,a.doChnk?"chnkpb":"normpb");let w="";if("object"==typeof D&&D.length){let d=b.name.split(".");if(1==d.length||0>D.indexOf(d.pop().toLowerCase()))w="<i class=\"fa fa-info-circle infoG\" onclick=\"alert('Allowed file types: ' + H5uOpts.allowed_file_types.join(', '));\"></i> File type not allowed"}else b.size>
e.maxfilesize&&(w="File is larger than allowed");if(w)a.pBar.msg(w,!0),C(b.size),a.X=null,v(!0,"errM");else return a.X.upload.onload=l.load,a.X.upload.onerror=l.fail,a.X.upload.onabort=l.abrt,a.X.upload.onprogress=l.prog,a.doChnk?k():g(),a}var e=Object.assign({},{lodrdiv:"uplodr",upURL:"upload.php",payload:{},maxFilesize:134217728,dropMessage:"Drop files here to upload<br>(or click to select)",accept:"*",concurrent:3,maxchunksize:16777216,allowed_file_types:[],doneFunc:null},z),E,B,x,h=[],y=e.concurrent,
D=e.allowed_file_types,M=e.maxchunksize,q=!1,r=0,F=0,G=0,H=0,I=0,A=0,t,u,N="";let n=(b,a,c)=>{b=document.createElement(b);a&&(b.innerHTML=a);for(let g in c)b.setAttribute(g,c[g]);return b},J=b=>{b.stopPropagation();b.preventDefault();b.target.className="dragover"==b.type?"hover":"dropzone"},K=b=>{let a,c;b instanceof FileList||(J(b),b=b.target.files||b.dataTransfer.files);H&&(H=F=G=0);for(a=0;c=b[a];a++)F+=c.size,h.push(c),x.innerHTML=h.length,v(!1,"fsel");h.length>y&&(t.style.display="inline-block")},
O=()=>{if(!q){H=1;if("function"==typeof e.doneFunc){let b=I,a=A;setTimeout(function(){e.doneFunc(b,a)},500)}A=I=0}},v=(b,a)=>{b&&("ufo"==a&&I++,--r||O());!q&&h.length&&(!y||r<y)&&(b=h.shift(),new Q(b),r++,x.innerHTML=h.length);0>=h.length&&(t.style.display="none",u.style.display="none")},C=b=>{!E||0>b||(G+=b,E.style.width=100*G/F+"%")},m=(b,a)=>{for(let c in a)b.append(c,a[c])};f.H5uSetup=()=>{var b=$id(e.lodrdiv);f.File&&f.FileList?(b.appendChild(n("div",'<input type="file" name="userpictures" id="file_field" multiple="multiple" accept="'+
e.accept+'"><div class="drpmsg">'+e.dropMessage+"</div>",{id:"dropArea",onclick:"$id('file_field').click();"})),b.appendChild(n("div",'<div id="progress_report_name"></div><div id="progress_report_status" style="font-style: italic;"></div><div id="totprogress"><div id="progress_report_bar"></div></div><div>Files queued: <span id="qcount">0</span><div class="acti" id="qstop"><i class="fa fa-pause-circle pausQ" title="stop queue" onclick="H5uQctrl.stop()"></i></div><div class="acti" id="qgocan"><i class="fa fa-play-circle playQ" title="resume queue" onclick="H5uQctrl.go()"></i><i class="fa fa-times cancelQ" title="cancel queue" alt="" onclick="H5uQctrl.cancel()"></i></div></div><div id="fprogress"></div><div id="server_response"></div>',
{id:"progress_report",style:"position:relative"})),x=$id("qcount"),t=$id("qstop"),u=$id("qgocan"),$ae($id("file_field"),"change",K),(new XMLHttpRequest).upload&&(b=$id("dropArea"),$ae(b,"dragover",J),$ae(b,"dragleave",J),$ae(b,"drop",K),b.style.display="block",E=$id("progress_report_bar"),B=$id("fprogress")),"undefined"!==typeof Blob&&(N=Blob.prototype.slice?"slice":Blob.prototype.webkitSlice?"webkitSlice":Blob.prototype.mozSlice?"mozSlice":"")):b.appendChild(n("div","Can not use this upload method with the web browser that you are using.",
{}))};f.H5uQctrl={stop:function(){q=!0;t.style.display="none";u.style.display="inline-block"},go:function(){q=!1;t.style.display="inline-block";for(u.style.display="none";h.length&&r<y;)v(!1,"go")},cancel:function(){h.length=0;q=!1;u.style.display="none";x.innerHTML=0;r||O()}};f.H5uOpts=e;f.fupQadd2=K})(window,[],h5uOptions||{});