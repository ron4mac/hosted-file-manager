'use strict';function $id(g){return document.getElementById(g)}function $ae(g,q,C){if("object"===typeof q)for(let w in q)g.addEventListener(w,q[w],!1);else g.addEventListener(q,C,!1)}
(function(g,q,C){function w(b,d){let a=this;a.show=k=>{a.pb.style.width=100*k+"%";1===k&&(a.pb.className="indeterm")};a.msg=(k,x)=>{a.pbi.innerHTML+="<br />"+k;x?(a.pbi.className="pbfinf failure",D++):(a.pbi.className="pbfinf message",E++)};a.rmov=()=>{a.pbw._ufo=null;F.removeChild(a.pbw);a.fObj=null};let e=l("div","",{class:"pbwrp"});a.pb=e.appendChild(l("div","",{class:d}));a.pbi=e.appendChild(l("div",b.fn+'<i class="fa fa-window-close abortX" aria-hidden="true" onclick="this.parentNode.parentNode._ufo.abort(true);"></i>',
{class:"pbfinf"}));F.appendChild(e);a.pbw=e;a.pbw._ufo=b;a.fObj=b;return a}function T(b,d){let a=this;a.upFile=b;a.fn=b.fileName||b.name;a.size=b.size;a.upState="";a.doChnk=a.upFile.size>P;a.chnkSize=Math.round(P/2)-3072;a.relPath=b.webkitRelativePath||a.fn;a.uniqueId=a.size+"-"+a.relPath.replace(/[^0-9a-zA-Z_-]/img,"");a.actSize=a.startByte=a.lastsz=a.chnkNum=0;a.numChnks=Math.max(Math.floor(a.size/a.chnkSize),1);a.fData=a.pBar=null;a.upForm={};a.X=new XMLHttpRequest;const e=c=>{a.X&&(a.X.upload.onprogress=
null,a.X.onabort=null,a.X.onerror=null,a.X.onload=null,a.X=null);a.fData=null;c&&a.pBar&&(a.pBar.rmov(),a.pBar=null);y(!0,"ufo")},k=()=>{a.fData=new FormData;a.fData.append("faex",d);m(a.fData,f.payload)},x=()=>{k();switch(a.upState){case "":m(a.fData,a.upForm);a.fData.append("Filedata",a.upFile);a.upState="upld";break;case "upld":e(!0);return}a.X.open("POST",f.upURL);a.X.send(a.fData)},G=()=>{k();switch(a.upState){case "":m(a.fData,{chunkact:"pref",file:a.fn,size:a.size,ident:a.uniqueId});a.upState=
"chnk";break;case "chnk":m(a.fData,{chunkact:"chnk",ident:a.uniqueId,fname:a.fn,tchnk:a.numChnks});if(a.chnkNum==a.numChnks){e(!0);return}a.startByte=a.chnkNum*a.chnkSize;a.endByte=Math.min(a.size,(a.chnkNum+1)*a.chnkSize);a.size-a.endByte<a.chnkSize&&(a.endByte=a.size);a.actSize=a.endByte-a.startByte;a.fData.append("chnkn",++a.chnkNum);a.chnkNum==a.numChnks&&m(a.fData,a.upForm);a.fData.append("Filedata",a.upFile[Q](a.startByte,a.endByte));a.lastsz=0;break;case "abrt":a.X.timeout=1E4;m(a.fData,{chunkact:"abrt",
ident:a.uniqueId,fname:a.fn});a.upState="nil";break;case "nil":e();return}a.X.open("POST",f.upURL);a.X.send(a.fData)},p={prog:c=>{if(c.lengthComputable){var n=Math.round(c.loaded/c.total*a.actSize);"chnk"==a.upState&&a.chnkNum?(a.pBar.show((a.startByte+n)/a.size),H(n-a.lastsz),a.lastsz=n):"upld"==a.upState&&(a.pBar.show(c.loaded/c.total),n=Math.round(c.loaded/c.total*a.size),H(n-a.lastsz),a.lastsz=n)}},load:c=>{console.log(c);200<a.X.status||a.X.responseText.length?(a.pBar.msg(a.X.responseText,200<
a.X.status),e()):a.doChnk?G():x()},abrt:c=>{console.log(c);a.pBar.msg("-- Aborted",!0);a.doChnk?(a.upState="abrt",G()):e()},fail:c=>{console.log(c);a.pBar.msg(a.X.responseText,!0);e()}};a.abort=()=>{if(a.X){let c=a.X.readyState;4>c&&0!==c?a.X.abort():p.abrt()}else a.pBar.rmov(),a.pBar=null};a.pBar=new w(a,a.doChnk?"chnkpb":"normpb");let z="";if("object"==typeof I&&I.length){let c=b.name.split(".");if(1==c.length||0>I.indexOf(c.pop().toLowerCase()))z="<i class=\"fa fa-info-circle infoG\" onclick=\"alert('Allowed file types: ' + H5uOpts.allowed_file_types.join(', '));\"></i> File type not allowed"}else b.size>
f.maxfilesize&&(z="File is larger than allowed");if(z)a.pBar.msg(z,!0),H(b.size),a.X=null,y(!0,"errM");else return a.X.onload=p.load,a.X.upload.onerror=p.fail,a.X.onerror=p.fail,a.X.upload.onabort=p.abrt,a.X.upload.onprogress=p.prog,a.doChnk?G():x(),a}var f=Object.assign({},{lodrdiv:"uplodr",upURL:"upload.php",payload:{},maxFilesize:134217728,dropMessage:"Drop files here to upload<br>(or click to select)",accept:"*",concurrent:3,maxchunksize:16777216,allowed_file_types:[],doneFunc:null},C),J,F,A,
h=[],B=f.concurrent,I=f.allowed_file_types,P=f.maxchunksize,r=!1,t=0,K=0,L=0,M=0,N=0,D=0,E=0,u,v,Q="";let l=(b,d,a)=>{b=document.createElement(b);d&&(b.innerHTML=d);for(let e in a)b.setAttribute(e,a[e]);return b},R=b=>{b.target.className="dragenter"==b.type?"hover":""},O=b=>{let d,a;b instanceof FileList||("drop"==b.type&&b.preventDefault(),b=b.target.files||b.dataTransfer.files);M&&(M=K=L=0);for(d=0;a=b[d];d++)K+=a.size,h.push(a),A.innerHTML=h.length,y(!1,"fsel");h.length>B&&(u.style.display="inline-block")},
S=()=>{if(!r){M=1;if("function"==typeof f.doneFunc){let b=N,d=D,a=E;setTimeout(function(){f.doneFunc(b,d,a)},500)}D=N=E=0}},y=(b,d)=>{b&&("ufo"==d&&N++,--t||S());!r&&h.length&&(!B||t<B)&&(b=h.shift(),new T(b,$id("faex").value||"f"),t++,A.innerHTML=h.length);0>=h.length&&(u.style.display="none",v.style.display="none")},H=b=>{!J||0>b||(L+=b,J.style.width=100*L/K+"%")},m=(b,d)=>{for(let a in d)b.append(a,d[a])};g.H5uSetup=()=>{var b=$id(f.lodrdiv);g.File&&g.FileList?(b.appendChild(l("div",'<input type="file" name="userpictures" id="file_field" multiple="multiple" accept="'+
f.accept+'"><div class="drpmsg">'+f.dropMessage+"</div>",{id:"dropArea",onclick:"$id('file_field').click();"})),b.appendChild(l("div",'<div id="progress_report_name"></div><div id="progress_report_status" style="font-style: italic;"></div><div id="totprogress"><div id="progress_report_bar"></div></div><div>Files queued: <span id="qcount">0</span><div class="acti" id="qstop"><i class="fa fa-pause-circle pausQ" title="stop queue" onclick="H5uQctrl.stop()"></i></div><div class="acti" id="qgocan"><i class="fa fa-play-circle playQ" title="resume queue" onclick="H5uQctrl.go()"></i><i class="fa fa-times cancelQ" title="cancel queue" alt="" onclick="H5uQctrl.cancel()"></i></div></div><div id="fprogress"></div><div id="server_response"></div>',
{id:"progress_report",style:"position:relative"})),A=$id("qcount"),u=$id("qstop"),v=$id("qgocan"),$ae($id("file_field"),"change",O),b=new XMLHttpRequest,b.upload&&(b=$id("dropArea"),$ae(b,{dragenter:R,dragleave:R,dragover:d=>d.preventDefault(),drop:O}),b.style.display="block",J=$id("progress_report_bar"),F=$id("fprogress")),b=null,"undefined"!==typeof Blob&&(Q=Blob.prototype.slice?"slice":Blob.prototype.webkitSlice?"webkitSlice":Blob.prototype.mozSlice?"mozSlice":"")):b.appendChild(l("div","Can not use this upload method with the web browser that you are using.",
{}))};g.H5uQctrl={stop:function(){r=!0;u.style.display="none";v.style.display="inline-block"},go:function(){r=!1;u.style.display="inline-block";for(v.style.display="none";h.length&&t<B;)y(!1,"go")},cancel:function(){h.length=0;r=!1;v.style.display="none";A.innerHTML=0;t||S()}};g.H5uOpts=f;g.fupQadd2=O})(window,[],h5uOptions||{});